<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>伝言板アプリ</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>📝 伝言板アプリ</h1>
    </header>

    <!-- チーム選択 -->
    <section id="team-selection">
      <h2>チームを選択</h2>
      <select id="team-select">
        <option value="">-- チームを選択 --</option>
      </select>
      <button id="join-team-btn">参加</button>
      <button id="create-team-btn">新規作成</button>
    </section>

    <!-- キー入力（保護チームの場合） -->
    <section id="key-input" style="display:none;">
      <h2>🔒 キーを入力</h2>
      <input type="password" id="team-key" placeholder="チームキーを入力">
      <button id="verify-key-btn">認証</button>
    </section>

    <!-- メッセージエリア（★2カラムレイアウト） -->
    <section id="message-area" style="display:none;">
      <!-- ヘッダーバー -->
      <div class="message-header-bar">
        <h2 id="current-team-name"></h2>
        <button id="leave-team-btn">チームを退出</button>
      </div>

      <!-- ★2カラムレイアウト -->
      <div class="two-column-layout">
        <!-- 左カラム: セグメント管理 + 投稿フォーム -->
        <div class="left-column">
<!-- セグメント管理 -->
<div class="segment-controls">
  <!-- ★折りたたみヘッダーを追加（スマホのみ表示） -->
  <div class="segment-controls-header" onclick="toggleSegmentControls()">
    <h3>📂 セグメント・チーム管理</h3>
    <span class="segment-controls-toggle">▼</span>
  </div>
  
  <div class="segment-controls-content" id="segment-controls-content">
    <div class="segment-filter">
      <label>📂 セグメント:</label>
      <select id="segment-filter">
        <option value="ALL">ALL（すべて表示）</option>
      </select>
    </div>
    <div class="segment-actions">
      <button id="manage-segments-btn" class="secondary-btn">セグメント管理</button>
      <button id="manage-team-btn" class="secondary-btn">チーム管理</button>
    </div>
  </div>
</div>


        <!-- 投稿フォーム -->
        <div class="post-form">
          <h3 class="post-form-title">📝 投稿</h3>
  
            <!-- 名前とセグメントを横並びに -->
            <div class="post-form-row">
              <div class="name-input">
                <input type="text" id="user-name" placeholder="名前">
              </div>
              <div class="segment-wrapper">
                <div class="segment-select-wrapper">
                  <label for="segment-select">📂</label>
                  <select id="segment-select">
                    <option value="ALL">ALL</option>
                  </select>
                </div>
              </div>
            </div>
  
            <textarea id="message-text" placeholder="メッセージを入力"></textarea>
  
            <!-- ★ファイル選択ボタンを追加 -->
            <div class="file-input-wrapper">
              <label for="file-input" class="file-input-label">📎 ファイルを添付</label>
              <input type="file" id="file-input" accept="*/*" style="display: none;">
              <span id="file-name-display" class="file-name-display"></span>
              <button id="clear-file-btn" class="clear-file-btn" style="display: none;">✕</button>
            </div>
  
            <button id="post-btn">投稿</button>
          </div>
        </div>

        <!-- 右カラム: メッセージリスト -->
        <div class="right-column">
          <!-- 返信プレビューエリア -->
          <div id="reply-preview" style="display: none; background: #e3f2fd; padding: 10px; margin-bottom: 10px; border-radius: 5px; position: relative;">
            <button id="cancel-reply" style="position: absolute; top: 5px; right: 5px; background: #ff5252; color: white; border: none; border-radius: 50%; width: 25px; height: 25px; cursor: pointer; font-size: 16px; line-height: 1;">×</button>
            <strong>返信先:</strong>
            <div id="reply-content" style="margin-top: 5px; font-size: 0.9em; color: #555;"></div>
          </div>

          <!-- メッセージリスト -->
          <div id="messages-list"></div>
        </div>
      </div>

      <!-- セグメント管理モーダル -->
      <div id="segment-modal" class="modal" style="display:none;">
        <div class="modal-content">
          <span class="close-modal" id="close-segment-modal">&times;</span>
          <h3>📂 セグメント管理</h3>
          
          <div class="segment-list">
            <h4>現在のセグメント</h4>
            <ul id="segment-list-items"></ul>
          </div>
          
          <div class="segment-create">
            <h4>新しいセグメントを作成</h4>
            <input type="text" id="new-segment-name" placeholder="セグメント名（例：会議、住民対応）">
            <button id="create-segment-btn">作成</button>
          </div>
        </div>
      </div>
      
      <!-- チーム管理モーダル（新規追加） -->
      <div id="team-modal" class="modal" style="display:none;">
        <div class="modal-content">
          <span class="close-modal" id="close-team-modal">&times;</span>
          <h3>⚙️ チーム管理</h3>
    
          <div class="team-info">
            <h4>チーム情報</h4>
            <p><strong>チーム名:</strong> <span id="team-info-name"></span></p>
            <p><strong>保護状態:</strong> <span id="team-info-protected"></span></p>
          </div>
    
          <div class="team-edit">
            <h4>チーム名を変更</h4>
            <input type="text" id="new-team-name" placeholder="新しいチーム名">
            <button id="edit-team-name-btn">変更</button>
          </div>
    
          <div class="team-edit">
            <h4>チームキーを変更</h4>
            <input type="password" id="new-team-key" placeholder="新しいチームキー（空白=保護解除）">
            <button id="edit-team-key-btn">変更</button>
          </div>
    
          <div class="team-delete">
            <h4>チームを削除</h4>
            <p style="color: #e74c3c; font-size: 0.9em;">⚠️ チームを削除すると、すべてのメッセージとセグメントも削除されます。</p>
            <button id="delete-team-btn" class="delete-team-btn">チームを削除</button>
          </div>
        </div>
      </div>
    </section>
  </div>

  <script src="app.js"></script>
</body>
</html>